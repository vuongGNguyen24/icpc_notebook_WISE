\chapter{Number theory}

\section{Modular arithmetic}
	% \kactlimport{ModInt.h}
	\kactlimport{ModLog.h}
	\kactlimport{ModSqrt.h}

\section{Primality}
	\kactlimport{MillerRabin.h}
	\kactlimport{PrimePi.h}

\section{Divisibility}
	\kactlimport{ExtendedEuclide.h}
	% \kactlimport{CRT.h}
    
	\subsection{BÃ©zout's identity}
	For $a \neq $, $b \neq 0$, then $d=gcd(a,b)$ is the smallest positive integer for which there are integer solutions to
	$$ax+by=d$$
	If $(x,y)$ is one solution, then all solutions are given by
	$$\left(x+\frac{kb}{\gcd(a,b)}, y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$

	\subsection{Euler's $\phi$} 
    
    Euler's $\phi$ function is defined as $\phi(n):=\#$ of positive integers $\leq n$ that are coprime with $n$.

    $\phi(1)=1$, $p$ prime $\Rightarrow \phi(p^k)=(p-1)p^{k-1}$, $m,n$ coprime $\Rightarrow \phi(mn)=\phi(m)\phi(n)$.

    If $n=p_1^{k_1}p_2^{k_2} ... p_r^{k_r}$ then $\phi(n) = (p_1-1)p_1^{k_1-1}...(p_r-1)p_r^{k_r-1}$.
    $\phi(n)=n \cdot \prod_{p|n}(1-1/p)$.
    
    $\sum_{d|n} \phi(d) = n$, $\sum_{1\leq k \leq n, \gcd(k,n)=1} k = n \phi(n)/2, n>1$

    \textbf{Euler's thm}: $a,n$ coprime $\Rightarrow a^{\phi(n)} \equiv 1 \pmod{n}$.
    
    \textbf{Fermat's little thm}: $p$ prime $\Rightarrow a^{p-1} \equiv 1 \pmod{p}$ $\forall a$.

    \subsection{Wilson theorem}
    $n$ is prime $\iff (n - 1)! \equiv -1$ (mod $n$)

    \subsection{Kummer's theorem}
        Write $n$ in base $p$, i.e $n = a_0 p^0 + a_1 p^1 + a_2 p^2 + \dots + a_r p^r$. Let $S_p(x) = \sum_{i = 0}^{r} a_i$, i.e sum digits of $x$ in base $p$. Then:
            
        $v_p\binom{n}{k} = \frac{S_p(k) + S_p(n - k) - S_p(n)}{p - 1}$

        Which $v_p(x)$ is the largest exponent of $p$ is a divisors of $x$, i.e $x \equiv 0$ (mod $p$), $p \rightarrow max$ 

        $v_p\binom{n}{k} \sim 2\log_2 n$
\section{Gray code}
    Gray code $G(x)$ is a binary numbering system where two consecutive values differ in only one bit.
    For instance, the sequence of Gray codes for 3-bit numbers is: 000, 001, 011, 010, 110, 111, 101, 100.
    
    $G(x) = n \oplus (n >> 1)$
\section{Pythagorean Triples}
 The Pythagorean triples are uniquely generated by
 \[ a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}), \]
 with $m > n > 0$, $k > 0$, $m \bot n$, and either $m$ or $n$ even.

\section{Fact about primes}
	$p=962592769$ is such that $2^{21} \mid p-1$, which may be useful. For hashing
	use 970592641 (31-bit number), 31443539979727 (45-bit), 3006703054056749
	(52-bit). There are 78498 primes less than 1\,000\,000.

	% Primitive roots exist modulo any prime power $p^a$, except for $p = 2, a > 2$, and there are $\phi(\phi(p^a))$ many.
	% For $p = 2, a > 2$, the group $\mathbb Z_{2^a}^\times$ is instead isomorphic to $\mathbb Z_2 \times \mathbb Z_{2^{a-2}}$.

\section{Divisors}
	$\sum_{d|n} d = O(n \log \log n)$.
    $\sum_{d = 1} ^ {n} \frac{n}{d} = O(n \log n)$.
    The maximun number of divisors $d(n)$ with $n$ is about $O(n^{\frac{1}{3}})$. Here is the exact $d(n)$ for some value of $n$.
    \begin{tabular}{|c|c|c|c|c|c|}
        \hline
        $n$    & $5 \times 10^4$  & $5 \times 10^5$ & $10^7$ & $10^{10}$ & $10^{19}$  \\ \hline
        $d(n)$ & 100              & 200             & 448    & 2304   & 161\,280 \\ \hline
    \end{tabular}
